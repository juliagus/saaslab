"ControlId","FeatureName","Status","SupportedResources","Severity","PropertyPath","LineNumber","CurrentValue","ExpectedProperty","ExpectedValue","ResourcePath","ResourceLineNumber","Description","FilePath"
"Azure_Storage_DP_Encrypt_In_Transit","Storage","Passed","Microsoft.Storage/storageAccounts , Microsoft.Storage/storageAccounts/blobServices","High","resources[0].properties.supportsHttpsTrafficOnly","84","true","$.properties.supportsHttpsTrafficOnly","'True'","resources[0]","74","HTTPS protocol must be used for accessing Storage Account resources","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_Storage_BCDR_Enable_Soft_Delete","Storage","Passed","Microsoft.Storage/storageAccounts , Microsoft.Storage/storageAccounts/blobServices","Medium","resources[0].properties.deleteRetentionPolicy.enabled","86","true","$.properties.deleteRetentionPolicy.enabled","'True'","resources[0]","74","Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_BCDR_Use_Multiple_Instances","AppService","Failed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","Medium","resources[1].sku.capacity","100","""[parameters('appServicePlanInstances')]""","$.sku.capacity","GreaterThan 1","resources[1]","90","App Service must be deployed on a minimum of two instances to ensure availability","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_Config_Disable_Remote_Debugging","AppService","Passed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","High","resources[2].properties.remoteDebuggingEnabled","117","false","$.properties.siteConfig.remoteDebuggingEnabled | $.properties.remoteDebuggingEnabled","'False'","resources[2]","106","Remote debugging must be turned off for App Service","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_Config_Disable_Web_Sockets","AppService","Passed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","High","resources[2].properties.siteConfig.webSocketsEnabled","120","false","$.properties.siteConfig.webSocketsEnabled | $.properties.webSocketsEnabled","'False'","resources[2]","106","Web Sockets should be disabled for App Service","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_BCDR_Use_AlwaysOn","AppService","Failed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","Medium","Not found","-1","","$.properties.siteConfig.alwaysOn | $.properties.alwaysOn","'True'","resources[2] , resources[1]","90","'Always On' should be configured for App Service","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_Audit_Enable_Logging_and_Monitoring","AppService","Failed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","Medium","Not found","-1","","$.properties.siteConfig.requestTracingEnabled | $.properties.requestTracingEnabled","'True'","resources[2] , resources[1]","90","Auditing and Monitoring must be enabled for App Service","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_Audit_Enable_Logging_and_Monitoring","AppService","Failed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","Medium","Not found","-1","","$.properties.siteConfig.httpLoggingEnabled | $.properties.httpLoggingEnabled","'True'","resources[2] , resources[1]","90","Auditing and Monitoring must be enabled for App Service","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_Audit_Enable_Logging_and_Monitoring","AppService","Failed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","Medium","Not found","-1","","$.properties.siteConfig.detailedErrorLoggingEnabled | $.properties.detailedErrorLoggingEnabled","'True'","resources[2] , resources[1]","90","Auditing and Monitoring must be enabled for App Service","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_DP_Dont_Allow_HTTP_Access","AppService","Passed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","High","resources[2].properties.httpsOnly","116","true","$.properties.httpsOnly","'True'","resources[2]","106","App Service must only be accessible over HTTPS","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_AuthN_Use_AAD_for_Client_AuthN","AppService","Failed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","High","Not found","-1","","$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled","'True'","resources[2] , resources[1]","90","App Service must authenticate users using Azure Active Directory backed credentials","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_AuthN_Use_AAD_for_Client_AuthN","AppService","Failed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","High","Not found","-1","","$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId","Non-null string","resources[2] , resources[1]","90","App Service must authenticate users using Azure Active Directory backed credentials","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_AuthN_Use_Managed_Service_Identity","AppService","Failed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","Medium","Not found","-1","","$.identity.type","Allow 'SystemAssigned'","resources[2] , resources[1]","90","Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_DP_Use_Secure_TLS_Version","AppService","Passed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","High","resources[2].properties.siteConfig.minTlsVersion","119","1.2","$.properties.siteConfig.minTlsVersion | $.properties.minTlsVersion","GreaterThanOrEqual '1.2'","resources[2]","106","Use approved version of TLS for the App Service","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
"Azure_AppService_DP_Review_CORS_Request_Credential","AppService","Passed","Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config","Medium","Not found","-1","","$.properties.siteConfig.cors.supportCredentials | $.properties.cors.supportCredentials","'False'","resources[2] , resources[1]","90","Review use of credentials in CORS request for App Service","C:\Users\dascottr\source\AzureDevOps\dscottraynsford\Demonstrations\IroncladInfrastructure\src\infrastructure\all\azuredeploy.json"
